JIRA.OffsetAnchors=Class.extend({WEBKIT_SCROLL_DELAY:100,BUFFER:20,init:function(offsetElemSelector){this.offsetElemSelector=offsetElemSelector;this.listen()},offsetElement:function(){if(!this.$offsetElement){this.$offsetElement=AJS.$(this.offsetElemSelector)}return this.$offsetElement},targetElement:function(){var anchor=this.anchor();if(anchor){var escapedAnchor=AJS.escapeHtml(anchor);var targetElement;try{targetElement=AJS.$("#"+escapedAnchor+",a[name="+escapedAnchor+"]").filter(":visible")}catch(e){return null}if(targetElement.length!==0){return targetElement.eq(0)}}},_bottomOfOffsetElement:function(){return this.offsetElement().outerHeight()+this.offsetElement().offset().top},offsettedScrollPosition:function(targetElement){return targetElement.offset().top-this.BUFFER-this.offsetElement().outerHeight()},offset:function(){var targetElement,scrollPosition;targetElement=this.targetElement();this.scrolled=true;if(targetElement){scrollPosition=this.offsettedScrollPosition(targetElement);if(AJS.$.browser.safari){this._delayScrollForWebkit(scrollPosition)}else{AJS.$(window).scrollTop(scrollPosition)}}},_delayScrollForWebkit:function(scrollTarget){window.setTimeout(function(){AJS.$(window).scrollTop(scrollTarget)},this.WEBKIT_SCROLL_DELAY)},anchor:function(){return parseUri(window.location.href).anchor},listen:function(){var instance=this;AJS.$(window).one("scroll",function(){if(!instance.scrolled){instance.offset()}})}});